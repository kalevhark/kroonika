{% extends "wiki/wiki_base.html" %}
{% load static %}

{% block extra_head %}
{% endblock %}

{% block content %}
  {{ django_version }}<br>
  {{ request.HTTP_REFERER }}<br>
  <div>
    <form class="need-alert" id="formFeedback" method="post" action="{% url 'wiki:feedback' %}">
      {% csrf_token %}
      <!--      {{ form }}-->
      {% for field in form %}
        <div class="fieldWrapper">
          {{ field.errors }}
          {{ field.label_tag }} {{ field }}
          {% if field.help_text %}
            <p class="help">{{ field.help_text|safe }}</p>
          {% endif %}
        </div>
      {% endfor %}
      {% for field in form.visible_fields %}
        {{ field.html_name }}:{{ field.value }}
      {% endfor %}
      <input type="hidden" value="" name="g-recaptcha-response" class="g-recaptcha-response" >
      <input type="submit" value="Saada">
    <!--    <input type="hidden" name="g-recaptcha-response" id='recaptcha'>-->
    </form>
  </div>
  <div>
    {% for key, value in request.items %}
    <small>{{ key }}:{{ value }}</small><br>
    {% endfor %}
  </div>

{% endblock %}

{% block javascript %}
  <script>
    $(document).ready(function() {

      // Grabs form submit button
      var id=$("#formFeedback").data.formButtonId;
      alert(id)
      // Unbinds submit button on-click event
      lp.jQuery("#"+id).unbind("click tap touchstart");

      // Re-binds on-click event to add your own function
      lp.jQuery("#"+id).bind("click tap touchstart",function(e) {

        // Prevent submit
        e.preventDefault();
        e.stopPropagation();

	      /*
        Your custom validation stuff
        Your custom validation stuff
        Your custom validation stuff
        Your custom validation stuff
        */

        // Submit form
        $("#formFeedback").submit();
      });
    });
  </script>
{% endblock %}